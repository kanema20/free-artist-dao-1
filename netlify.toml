# The following redirect is intended for use with most SPAs that handle
# routing internally.
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
[[headers]]
  for = "/*"
    [headers.values]
    Access-Control-Allow-Origin = "https://gnosis-safe.io/"
    X-Frame-Options = "SAMEORIGIN"
    Content-Security-Policy = "frame-ancestors 'self'"
[build]
  # Directory that contains the deploy-ready HTML files and assets generated by
  # the build. This is relative to the base directory if one has been set, or the
  # root directory if a base has not been set. This sample publishes the
  # directory located at the absolute path "root/project/build-output"
  publish = "packages/client/build/"

  # Default build command.
  #
  # Concurrency is set to 2 as Netlify empirically has issues bootstrapping with high concurrency and will fail with various errors.
  # To make up for the lower concurrency, ignore the subgraph and server which are not required to build the client (and use build-netlify which
  # skips building those packages)
  command = "CI= && npx lerna bootstrap --ci --scope @goldfinch-eng/client --include-dependencies && npx lerna run --scope @goldfinch-eng/client build --include-dependencies --stream"
